# Template Customization Guide

## Overview

Templates define the structure and required information for specs, issues, and implementation plans. Commands read templates to determine what questions to ask and what sections to generate.

**Key Principle**: Templates define **structure** ("what sections"), commands provide **intelligence** ("how to create good content").

## Available Templates

This directory contains 4 templates:

1. **spec.md** - Feature specs with goals and task lists
2. **task.md** - User stories and development tasks
3. **bug.md** - Bug reports with reproduction steps
4. **plan.md** - Implementation plans (created by `/plan` command)

## How Templates Work

### Template Discovery

Commands use convention-based template lookup:

```
TASK-001 → looks for templates/task.md
BUG-003  → looks for templates/bug.md
SPIKE-007 → looks for templates/spike.md (custom template you can create)
```

The issue prefix (lowercased) determines which template to use.

### PLAN.md Template

The **plan.md** template is special - it's used by the `/plan` command to create separate PLAN.md files:

```
/plan TASK-001 → creates pm/issues/TASK-001-*/PLAN.md
/plan BUG-003  → creates pm/issues/BUG-003-*/PLAN.md
```

**Why separate PLAN.md?**
- TASK.md/BUG.md stay clean for PM tool sync (Jira, Linear)
- PLAN.md contains AI-managed implementation details
- No conflicts between external PM updates and internal planning

### Template Processing

1. **Command reads template frontmatter** - Parses section definitions, requirements, prompts
2. **Command starts conversation** - Asks questions based on template prompts
3. **Command applies intelligence** - Adds context loading, complexity analysis, agent coordination
4. **Command generates content** - Creates file following template structure with smart content

## Template Format

Templates consist of two parts:

### 1. Frontmatter (YAML)

Defines metadata about sections:

```yaml
---
type: task  # Issue type identifier
sections:
  - name: Description
    prompt: "What does this task accomplish?"
    required: true
    format: paragraph
    hint: "Guidance for what to include"
  - name: Plan
    auto: true
    hint: "Auto-generated by /plan command"
---
```

### 2. Markdown Structure

Shows the expected file format:

```markdown
# TASK-{id}: {name}

## Description
{description}

## Plan
{plan}
```

## Frontmatter Options

### Section Fields

**name** (required)
- Section heading in generated file
- Example: `"Description"`, `"Acceptance Criteria"`, `"Fix Plan"`

**prompt** (optional)
- Question to ask user during creation
- Example: `"What does this task accomplish?"`
- If omitted, command may skip user prompt for this section

**required** (optional, default: false)
- Whether this section must be completed
- `true` = command will prompt user until answered
- `false` = section can be skipped or auto-generated

**format** (optional, default: "text")
- Expected content format
- Options: `text`, `paragraph`, `checklist`, `list`, `numbered-list`, `structured`, `flexible`
- Guides command on how to format user input

**auto** (optional, default: false)
- Whether section is auto-generated by commands
- `true` = command generates content (like `/plan` generates Plan section)
- `false` = requires user input

**hint** (optional)
- Additional guidance for users or commands
- Shows in conversational prompts
- Explains what content should include

### Example Section Definitions

**Required user input:**
```yaml
- name: Description
  prompt: "What does this task accomplish?"
  required: true
  format: paragraph
  hint: "Clear explanation of what will be built and why."
```

**Optional user input:**
```yaml
- name: Technical Notes
  prompt: "Any technical considerations?"
  required: false
  format: paragraph
  hint: "Architecture decisions, gotchas, ADR references."
```

**Auto-generated content:**
```yaml
- name: Plan
  prompt: "Phase-based implementation breakdown"
  required: false
  format: structured
  auto: true
  hint: "Auto-generated by /plan command."
```

**Flexible format:**
```yaml
- name: Definition of Done
  prompt: "How will we know this is complete?"
  required: true
  format: flexible
  hint: "Can be prose paragraph or bulleted checklist."
```

## Creating Custom Issue Types

### 1. Create Template File

Add new template to `templates/` directory:

```bash
# For SPIKE-### issues
templates/spike.md

# For RFC-### issues
templates/rfc.md

# For DEBT-### issues
templates/debt.md
```

### 2. Define Template Structure

Example `templates/spike.md`:

```yaml
---
type: spike
sections:
  - name: Research Question
    prompt: "What are we investigating?"
    required: true
    format: paragraph
  - name: Success Criteria
    prompt: "What will we learn? How will we know we're done?"
    required: true
    format: checklist
  - name: Approach
    prompt: "How will we investigate this?"
    required: false
    format: list
  - name: Findings
    prompt: "What did we learn?"
    required: false
    auto: true
    hint: "Update this as research progresses"
  - name: Recommendations
    prompt: "What should we do based on findings?"
    required: false
    auto: true
    hint: "Fill in at spike conclusion"
---

# SPIKE-{id}: {name}

## Research Question
{research_question}

## Success Criteria
{success_criteria}

## Approach
{approach}

## Findings
{findings}

## Recommendations
{recommendations}
```

### 3. Use Custom Type

Once template exists, create issues with that type:

```bash
# Commands will automatically find templates/spike.md
/spec    # Add SPIKE-001 to spec task list
/plan SPIKE-001    # Will use spike template for structure
```

## Template Examples

### Simple Template (Minimal Sections)

```yaml
---
type: experiment
sections:
  - name: Hypothesis
    prompt: "What are we testing?"
    required: true
    format: paragraph
  - name: Results
    prompt: "What happened?"
    required: false
    auto: true
---

# EXPERIMENT-{id}: {name}

## Hypothesis
{hypothesis}

## Results
{results}
```

### Complex Template (Many Sections)

```yaml
---
type: rfc
sections:
  - name: Summary
    prompt: "Brief overview of the proposal"
    required: true
    format: paragraph
  - name: Motivation
    prompt: "Why are we doing this?"
    required: true
    format: paragraph
  - name: Detailed Design
    prompt: "How will this work?"
    required: true
    format: structured
  - name: Alternatives Considered
    prompt: "What other approaches did we consider?"
    required: false
    format: list
  - name: Impact
    prompt: "What will this affect?"
    required: true
    format: list
  - name: Implementation Plan
    auto: true
    hint: "Generated by /plan command"
---

# RFC-{id}: {name}

## Summary
{summary}

## Motivation
{motivation}

## Detailed Design
{detailed_design}

## Alternatives Considered
{alternatives_considered}

## Impact
{impact}

## Implementation Plan
{implementation_plan}
```

## Built-in Templates

### Epic Template

Five essential fields:
- **Name** - Epic identifier
- **Description** - Problem, context, value
- **Definition of Done** - Completion criteria (flexible format)
- **Dependencies** - ADRs, other specs, external factors
- **Tasks** - Checkbox list of issue IDs

### Task Template

Standard implementation work:
- **Description** - What will be built and why
- **Acceptance Criteria** - Testable completion criteria
- **Technical Notes** - Architecture, constraints, references
- **Plan** - Phase-based breakdown (auto-generated by `/plan`)

### Bug Template

Defect tracking:
- **Description** - Bug summary and impact
- **Reproduction Steps** - How to reproduce consistently
- **Expected Behavior** - What should happen
- **Actual Behavior** - What actually happens
- **Environment** - OS, browser, version, etc.
- **Fix Plan** - Root cause analysis and fix approach (auto-generated by `/plan`)

## Modifying Existing Templates

You can customize built-in templates:

### Add a Section

```yaml
sections:
  - name: Related Issues
    prompt: "What other issues relate to this?"
    required: false
    format: list
```

### Change Requirements

```yaml
sections:
  - name: Technical Notes
    required: true  # Make previously optional section required
```

### Adjust Prompts

```yaml
sections:
  - name: Description
    prompt: "What problem does this solve? How does it provide value?"
    hint: "Focus on user value and business impact."
```

## Best Practices

### Template Design

- **Keep it focused** - Only include sections you'll consistently use
- **Make prompts clear** - Users should know exactly what to provide
- **Use hints generously** - Guide users on what good content looks like
- **Mark auto-generated sections** - Set `auto: true` for command-generated content
- **Choose appropriate formats** - Use format hints to guide content structure

### Section Organization

- **Required first** - Put must-have sections at the top
- **Optional next** - Place nice-to-have sections in middle
- **Auto-generated last** - Put command-generated sections at end

### Naming Conventions

- **Use clear prefixes** - SPIKE, RFC, DEBT, EXPERIMENT, etc.
- **Keep templates lowercase** - File names should be `spike.md` not `SPIKE.md`
- **Match prefix to template** - SPIKE-001 uses `templates/spike.md`

## Troubleshooting

**Command doesn't find my template:**
- Verify file name matches issue prefix (lowercased): `SPIKE-001` → `templates/spike.md`
- Check template is in correct directory: `pm/templates/`
- Ensure template has valid YAML frontmatter

**Sections not generating correctly:**
- Validate YAML syntax in frontmatter
- Check section names match placeholders in markdown: `{description}` needs `name: Description`
- Ensure required sections have `required: true`

**Template changes not taking effect:**
- Commands read templates at execution time
- Existing issues don't automatically update when templates change
- Re-run commands (like `/plan`) to apply new template structure

## Related Documentation

- **System Guide**: `../README.md` - Overview of pm/ structure and workflow
- **Commands**: Plugin commands documentation for command-specific behavior

**For workflow and process guidance**:
- `docs/development/guidelines/pm-guide.md` - Agile plan updates, living documents, review cycles
- `docs/development/guidelines/task-workflow.md` - Review-and-adapt process, quality gates
